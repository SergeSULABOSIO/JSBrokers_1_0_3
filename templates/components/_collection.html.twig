{#
    Ce template est un widget de formulaire qui gère une collection d'entités (ex: une liste de contacts pour un client).
    Il est piloté par le contrôleur Stimulus `collection` (anciennement `collection-manager`).

    Fonctionnement :
    - Il affiche une liste d'éléments existants.
    - Il permet "d'ajouter", "de modifier" ou "de supprimer" des éléments de la collection via des boîtes de dialogue modales.
    - Les interactions (ajout, suppression) sont gérées via des appels AJAX pour une expérience utilisateur fluide.
    - Il se rafraîchit automatiquement lorsqu'une entité de la collection est sauvegardée.

    Paramètres attendus (via le thème de formulaire `_collection_widget.html.twig`):
    - `items`: La collection d'entités à afficher.
    - `item_template`: Le chemin vers le template Twig qui sait comment afficher un seul élément de la collection.
#}
<div
    id="collection-list-{{ random() }}" 
    class="collection-container p-2" 
    data-controller="collection" 
    data-collection-url-value=""  
    data-collection-create-title-value="Nouvel élément" 
    data-collection-edit-title-value="Modifier l'élément" 
>
    {# Cible pour le contenu principal #}
    <div data-collection-target="contentPanel">
        {# Cible pour la liste des éléments elle-même #}
        <div data-collection-target="listContainer">
            {% if items is not empty and items|length > 0 %}
                {% for item in items %}
                    {# On inclut le sous-template spécifique pour chaque élément de la boucle #}
                    {% include item_template with {'item': item} %}
                {% endfor %}
            {% else %}
                <div class="text-center p-4 text-muted"><em>Aucun élément dans cette collection.</em></div>
            {% endif %}
        </div>
    </div>
    {# Cible pour le conteneur du bouton "Ajouter" #}
    <div data-collection-target="addButtonContainer"></div>

    {# Cible pour le compteur d'éléments (badge) - peut être caché #}
    <span data-collection-target="countBadge" class="d-none"></span>
</div>