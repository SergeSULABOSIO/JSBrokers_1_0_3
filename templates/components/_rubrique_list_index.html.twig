{# templates/components/_rubrique_list_index.html.twig #}
<div 
    class="d-flex flex-column h-100"
    data-controller="list-tabs"
    data-list-tabs-entity-canvas-value='{{ entityCanvas|json_encode|e('html_attr') }}'
>
    {# ================================================================== #}
    {# SECTION 1 : PANNEAU SUPÉRIEUR FIXE (HEADER & OUTILS)             #}
    {# ================================================================== #}
    <div class="sticky-header bg-white shadow-sm">
        <div class="d-flex align-items-center p-2">
            <div class="me-2">
                <twig:UX:Icon 
                    name="{{ entityCanvas.parametres.icone | default('lucide:file-text') }}" 
                    style="width: 40px; height: 40px; color: #343a40;"
                    data-list-tabs-target="rubriqueIcon"
                />
            </div>
            <div class="flex-grow-1">
                <div class="rubrique-title" data-list-tabs-target="rubriqueName">{{ rubrique_nom }}</div>
                <div class="list-tabs-container" data-list-tabs-target="tabsContainer">
                    <button class="list-tab active" data-tab-id="principal" data-action="click->list-tabs#switchTab">Principal</button>
                </div>
            </div>
        </div>
        <div class="p-2">{{ include("components/_liste_barre_outils.html.twig") }}</div>
        <div class="p-2 pt-0">{{ component('_search_bar') }}</div>
        <div class="p-2 pt-0">{{ include('components/_totals_bar.html.twig') }}</div>
        <div class="p-2 small text-muted" data-list-tabs-target="display">Prêt.</div>
    </div>

    {# ================================================================== #}
    {# SECTION 2 : ZONE DE CONTENU DYNAMIQUE (LISTES)                   #}
    {# ================================================================== #}
    <div class="flex-grow-1" style="overflow-y: auto;" data-list-tabs-target="tabContentContainer">
        <div data-content-id="principal" data-entity-name="{{ entite_nom }}" data-can-add="true">
            {# On utilise notre nouveau composant générique pour la liste principale #}
            {{ include('components/_generic_list_component.html.twig', {
                'data': data,
                'entite_nom': entite_nom,
                'entityCanvas': entityCanvas,
                'listeCanvas': listeCanvas,
                'entityFormCanvas': entityFormCanvas
            }) }}
        </div>
    </div>
    {{ include('components/_menu_contextuel.html.twig') }}
    <div data-controller="dialog-manager"></div>
</div>