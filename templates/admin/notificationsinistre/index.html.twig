<div 
    data-controller = "rubrique" 
    data-rubrique-nom-value = "Notification Sinistre"
    class="d-flex flex-column h-100"
>
    <div 
        id = "liste" 
        class="flex-grow-1 d-flex flex-column" 
        data-controller="dialogue liste-principale" 
        data-liste-principale-identreprise-value={{entreprise.id}} 
        data-liste-principale-idutilisateur-value={{utilisateur.id}} 
        data-liste-principale-nbelements-value={{notificationsinistres|length}} 
        data-liste-principale-rubrique-value="Notification Sinistre" 
        data-liste-principale-entite-value="NotificationSinistre" 
        data-liste-principale-controleurphp-value="notificationsinistre" 
        data-liste-principale-controleurstimulus-value="notificationsinistre-formulaire" 
        {# data-liste-principale-controleurstimulusformulaire-value="notificationsinistre-formulaire"  #}
    >
        {# Ce conteneur va aussi utiliser flexbox et cacher tout débordement #}
        <div class="shadow-sm sensible bg-white d-flex flex-column flex-grow-1" style="overflow: hidden;">
            {# Les barres d'outils ne grandissent pas #}
            <div class="flex-shrink-0">
                {# Barre d'outils #} 
                {{ include("components/_liste_barre_outils.html.twig") }}
                {# Barre de Recherche #}
                {{ component('_search_bar') }}
                {# Barre des totaux #}
                {{ include('components/_totals_bar.html.twig') }}
            </div>

            {# NOUVEAU : Un wrapper pour le tableau qui gère le défilement #}
            <div class="table-scroll-wrapper flex-grow-1">
                {# Tableau #}
                <table class="table table-hover table-sm caption-top p-3 table-enhanced">
                    <caption>
                        <span data-liste-principale-target = "display">
                            {% if notificationsinistres|length == 0 %}
                                {{ "list_filter_result_empty" | trans}}
                            {% else %}
                                {{ "list_filter_result_elements" | trans({
                                    ':number': notificationsinistres|length
                                })}}
                            {% endif %}
                        </span>
                        <div class="d-flex gap-1">
                            {{ knp_pagination_render(notificationsinistres) }}
                        </div>
                    </caption>
                    {% if notificationsinistres|length != 0 %}
                        {# MODIFICATION : On ajoute une classe pour rendre l'en-tête collant #}
                        <thead class="table-light sticky-header">
                            <tr class="text-center">
                                <th scope="col">
                                    {# Checkbox de selection ici #}
                                    <div class="form-check m-2 justify-content-start">
                                        <input 
                                            class="form-check-input" 
                                            value="" 
                                            type="checkbox" 
                                            id="myCheckbox" 
                                            data-action="change->liste-principale#handleItemToutCocher" 
                                            data-liste-principale-target="selectAllCheckbox"
                                        >
                                        <label 
                                            for="myCheckbox"
                                            class="text-secondary" 
                                        >
                                            Id.  
                                        </label>
                                    </div>
                                </th>
                                <th scope="col">
                                    <div class='d-flex justify-content-start text-secondary m-2'>
                                        {{ "list_of_object" | trans }}
                                    </div>
                                </th>
                                <th scope="col" style="width:100px" >
                                    <div class='d-flex justify-content-end'>
                                        {# {{ "note_list_actions" | trans }} #}
                                    </div>
                                </th>
                            </tr>
                        </thead>
                        <tbody class="table-group-divider context-target" data-liste-principale-target = "donnees">
                            {{ include('admin/notificationsinistre/donnees.html.twig') }}
                        </tbody>
                    {% endif %}
                </table>
            </div>


            
        </div>
        {{ include('components/_menu_contextuel.html.twig') }}
        {{ include('components/_dialogue.html.twig') }}
    </div>
</div>